@if (trackForm) {
<div class="full-width">
    <h3>Create New Track</h3>

  <form [formGroup]="trackForm" #parentForm='ngForm' (ngSubmit)="createTrack()">
  
      <mat-form-field class="full-width">
        <mat-label>Code*</mat-label>
        <input matInput formControlName="code" [errorStateMatcher]="matcher" />
        <mat-hint align="end">Lower case letters, one word or hyphenated, max 50 characters</mat-hint>
      </mat-form-field>
  
      <mat-form-field class="full-width">
        <mat-label>Name*</mat-label>
        <input matInput formControlName="name" [errorStateMatcher]="matcher"/>
      </mat-form-field>

       <mat-form-field class="full-width">
      <mat-label>Icon*</mat-label>
      <mat-select formControlName="icon" [errorStateMatcher]="matcher">
        <mat-option [value]="image.path" *ngFor="let image of icons$ | async">{{ image.name }}</mat-option>
      </mat-select>
    </mat-form-field>
  
      <div class="contentPickerTitle" *ngIf="addedCourses && addedCourses.length">
        <span>Courses to be added to the new track (in this order):</span>
        <table mat-table class="content-table mat-elevation-z8" [dataSource]="courseDataSource">  
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef> Course name </th>
            <td mat-cell *matCellDef="let course"> {{ course.name }} </td>
          </ng-container>
  
          <ng-container matColumnDef="order">
            <th mat-header-cell *matHeaderCellDef> Change Order </th>
            <td mat-cell *matCellDef="let course"> 
              <button mat-stroked-button color="primary" (click)="changeCourseOrderUp(course.courseId)" type="button">&#8593;</button>
              <button mat-stroked-button color="primary" (click)="changeCourseOrderDown(course.courseId)" type="button">&#8595;</button>
            </td>
          </ng-container>
  
          <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef> Action </th>
            <td mat-cell *matCellDef="let course"> 
              <button mat-stroked-button color="error" (click)="deleteCourse(course.courseId)" type="button">Delete</button>
            </td>
          </ng-container>
  
          <tr mat-header-row *matHeaderRowDef="displayedCourseColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedCourseColumns;"></tr>
        </table>
      </div>
  
        <mat-form-field class="full-width">
          <mat-label>Assign course to track*</mat-label>
          <mat-select formControlName="course" (selectionChange)="addCourse()">
          <mat-option [value]="course" *ngFor="let course of courses$ | async">{{ course.name }}</mat-option>
          </mat-select>
          <mat-hint align="end">Create new courses by selecting Course above</mat-hint>
        </mat-form-field>

      <div class="contentPickerTitle" *ngIf="addedGroups && addedGroups.length">
        <span>Track will be restricted to the following groups:</span>
        <table mat-table class="content-table mat-elevation-z8" [dataSource]="groupDataSource">
          <ng-container matColumnDef="name">
            <th mat-header-cell *matHeaderCellDef> Group </th>
            <td mat-cell *matCellDef="let group"> {{ group.groupName }} </td>
          </ng-container>
  
          <ng-container matColumnDef="action">
            <th mat-header-cell *matHeaderCellDef> Action </th>
            <td mat-cell *matCellDef="let group"> 
              <button mat-stroked-button color="error" (click)="deleteGroup(group.groupName)" type="button">Delete</button>
            </td>
          </ng-container>
  
          <tr mat-header-row *matHeaderRowDef="displayedGroupColumns"></tr>
          <tr mat-row *matRowDef="let row; columns: displayedGroupColumns;"></tr>
        </table>
      </div>
  
        <mat-form-field class="full-width">
          <mat-label>Restrict content to group</mat-label>
          <mat-select formControlName="restrictions" (selectionChange)="addGroup()">
            <mat-option [value]="group" *ngFor="let group of groups$ | async">{{ group.groupName }}</mat-option>
          </mat-select>
          <mat-hint align="end">Create new groups by selecting Group above</mat-hint>
        </mat-form-field>
  
      <div class="error" *ngIf="error">
        Please ensure all required fields are filled in and that there are no errors above.
      </div>
  
      <div class="buttons">
      <button mat-raised-button color="primary" type="submit">Save</button>
      <button mat-raised-button color="warn" type="button" (click)="cancel()">Cancel</button>      
      </div>
    </form>
  </div>
} @else {
  <!-- Do not display form -->
}

  