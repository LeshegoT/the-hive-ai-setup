@if (courseForm) {
<div class="full-width">
  <h3>Create New Course</h3>
  <p>
    Before creating a course, it must be in a folder inside the Azure courses directory (this is used when adding sections later).
    Look at other courses in this directory to understand the structure as well as how images are stored (inside an images folder) and used.
    Additionally, the icon must exist in the app/images/logos directory.
    <a href="mailto:atcteam@bbd.co.za?Subject=Upload Course Help">ATC</a> can help you with these steps.
  </p>
<form [formGroup]="courseForm" #parentForm="ngForm">

  <mat-form-field class="full-width">
    <mat-label>Code*</mat-label>
    <input matInput formControlName="code" [errorStateMatcher]="matcher" />
    <mat-hint align="end">Lower case letters, one word or hyphenated, max 50 characters</mat-hint>
  </mat-form-field>

  <mat-form-field class="full-width">
    <mat-label>Name*</mat-label>
    <input matInput formControlName="name" [errorStateMatcher]="matcher" />
  </mat-form-field>

  <mat-form-field class="full-width">
      <mat-label>Icon*</mat-label>
      <mat-select formControlName="icon" [errorStateMatcher]="matcher">
        <mat-option [value]="image.path" *ngFor="let image of icons$ | async">{{ image.name }}</mat-option>
      </mat-select>
    </mat-form-field>

  <mat-form-field class="full-width">
    <mat-label>Description*</mat-label>
    <textarea matInput formControlName="description" [errorStateMatcher]="matcher" ></textarea>
  </mat-form-field>

  <div class="full-width addContentBlock">
    <mat-form-field class="full-width">
      <mat-label>Assign course to track</mat-label>
      <mat-select formControlName="trackId">
        <mat-option [value]="track.trackId" *ngFor="let track of tracks$ | async">{{ track.name }}</mat-option>
      </mat-select>
      <mat-hint align="end">Create new tracks by selecting Track above</mat-hint>
    </mat-form-field>
  </div>
   <app-create-new-track (updateTrack)="updateTrack()"></app-create-new-track>

  <div class="contentPickerTitle" *ngIf="addedGroups && addedGroups.length">
    <span>Track will be restricted to the following groups:</span>
    <table mat-table class="content-table mat-elevation-z8" [dataSource]="groupDataSource">
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef> Group </th>
        <td mat-cell *matCellDef="let group"> {{ group.groupName }} </td>
      </ng-container>

      <ng-container matColumnDef="action">
        <th mat-header-cell *matHeaderCellDef> Action </th>
        <td mat-cell *matCellDef="let group"> 
          <button mat-stroked-button color="error" (click)="deleteGroup(group.groupName)" type="button">Delete</button>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedGroupColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedGroupColumns;"></tr>
    </table>
  </div>

    <mat-form-field class="full-width">
      <mat-label>Restrict content to group</mat-label>
      <mat-select formControlName="restrictions" (selectionChange)="addGroup()">
       <mat-option [value]="group" *ngFor="let group of groups$ | async">{{ group.groupName }}</mat-option>
      </mat-select>
    </mat-form-field>

  
  <app-section-editor [parentFormGroup]="courseForm" [sections]="addedSections" button="Add"></app-section-editor>

  <div class="error" *ngIf="error">
    Please ensure all required fields are filled in and that there are no errors above.
  </div>

  <div class="buttons">
    <button mat-raised-button color="primary" (click)="createCourse()" type="button">Save</button>
    <button mat-raised-button color="warn" type="button" (click)="cancel()">Cancel</button>
  </div>
</form>
</div>
} @else {
  <!-- Do not display form -->
}