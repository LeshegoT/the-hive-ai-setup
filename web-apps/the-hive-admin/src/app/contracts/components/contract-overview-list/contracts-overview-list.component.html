@if (contractStaffDataSource) {
    @if (contractStaffDataSource.data.length !== 0) {
        <table mat-table [dataSource]="contractStaffDataSource" matSort>

            <ng-container matColumnDef="displayName">
                <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by name"> Staff Name </th>
                <td mat-cell *matCellDef="let element"> {{element.displayName}} </td>
            </ng-container>

            <ng-container matColumnDef="reviewer">
                <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by reviewer"> Reviewer </th>
                <td mat-cell *matCellDef="let element"> {{element.reviewer}} </td>
            </ng-container>

            <ng-container matColumnDef="department">
                <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by department"> Unit </th>
                <td mat-cell *matCellDef="let element"> {{element.department}} </td>
            </ng-container>

            <ng-container matColumnDef="entity">
                <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by entity"> Entity </th>
                <td mat-cell *matCellDef="let element"> {{element.entity}} </td>
            </ng-container>

            <ng-container matColumnDef="office">
                <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by office"> Office </th>
                <td mat-cell *matCellDef="let element"> {{element.office}} </td>
            </ng-container>

            <ng-container matColumnDef="employmentDate">
                <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by joined date"> Joined Date </th>
                <td mat-cell *matCellDef="let element"> {{element.employmentDate | date}} </td>
            </ng-container>

            <ng-container matColumnDef="hasActiveContractRecommendation">
                <th mat-header-cell *matHeaderCellDef mat-sort-header sortActionDescription="Sort by review status"> Review Status </th>
                <td mat-cell *matCellDef="let element"> 
                    {{ element.hasActiveContractRecommendation ? 'In Progress' : 'No Active Review'}} 
                </td>
            </ng-container>

            <ng-container matColumnDef="hrReps">
                <th mat-header-cell *matHeaderCellDef>HR Rep</th>
                <td mat-cell *matCellDef="let element"> 
                    {{ element.hrRep}}
                </td>
            </ng-container>

        <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef></th>
            <td mat-cell *matCellDef="let element">
                <button 
                    [disabled]="element.hasActiveContractRecommendation" 
                    mat-icon-button 
                    [ngClass]="{'action-button': !element.hasActiveContractRecommendation}"
                    type="button"
                    (click)="emitStaffForPermanentRole(element); $event.stopPropagation();"
                    matTooltip="{{ element.hasActiveContractRecommendation ? 'Cannot change the contractor to a permanent employee because their contract is currently under review.' : 'Make permanent' }}">
                    <mat-icon>metabolism</mat-icon>
                </button>
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns, sticky: true"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;" class="selectable-row" [class.selected]="isRowSelected(row)" (click)="showContractHistoryForStaff(row); setSelectedRow(row)" id="{{row.staffId}}"></tr>

        </table>
        <mat-paginator
            #paginator
            [length]="pageInfo().resultSetSize"
            [pageIndex]="pageInfo().pageNumber"
            [pageSize]="pageInfo().pageSize" 
            [pageSizeOptions]="this.tableService.getPageSizeOptions()" 
            [showFirstLastButtons]="this.tableService.getShowFirstLastButtons()" 
            [hidePageSize]="this.tableService.getHidePageSize()"
            (page)="pageChanged($event)">
        </mat-paginator>
    } @else {
        <p id="no-contractors">There are no contractors to show</p>
    }
} @else {
    <mat-spinner></mat-spinner>
}
